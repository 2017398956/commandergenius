From 6e8c23fd95493265aa393bb9e4fd7ddb5078ac9f Mon Sep 17 00:00:00 2001
From: Juanjo <juanjo.ng.83@gmail.com>
Date: Mon, 14 Oct 2013 18:10:26 +0000
Subject: [PATCH 237/249] Erase queued command also when depot
 direction/airport type/station type changes.

---
 src/airport_gui.cpp | 2 ++
 src/dock_gui.cpp    | 1 +
 src/rail_gui.cpp    | 3 +++
 src/road_gui.cpp    | 2 ++
 4 files changed, 8 insertions(+)

diff --git a/src/airport_gui.cpp b/src/airport_gui.cpp
index c927ef4..fa9d1b7 100644
--- a/src/airport_gui.cpp
+++ b/src/airport_gui.cpp
@@ -423,6 +423,8 @@ public:
 
 	void UpdateSelectSize()
 	{
+		EraseQueuedTouchCommand();
+
 		if (_selected_airport_index == -1) {
 			SetTileSelectSize(1, 1);
 			this->DisableWidget(WID_AP_LAYOUT_DECREASE);
diff --git a/src/dock_gui.cpp b/src/dock_gui.cpp
index 934ff9e..701a597 100644
--- a/src/dock_gui.cpp
+++ b/src/dock_gui.cpp
@@ -474,6 +474,7 @@ public:
 				_settings_client.gui.station_show_coverage = (widget != BDSW_LT_OFF);
 				this->LowerWidget(_settings_client.gui.station_show_coverage + BDSW_LT_OFF);
 				if (_settings_client.sound.click_beep) SndPlayFx(SND_15_BEEP);
+				EraseQueuedTouchCommand();
 				this->SetDirty();
 				break;
 		}
diff --git a/src/rail_gui.cpp b/src/rail_gui.cpp
index ce9d105..a0fa459 100644
--- a/src/rail_gui.cpp
+++ b/src/rail_gui.cpp
@@ -1365,6 +1365,8 @@ public:
 				break;
 			}
 		}
+
+		EraseQueuedTouchCommand();
 	}
 
 	virtual void OnTick()
@@ -1723,6 +1725,7 @@ struct BuildRailDepotWindow : public PickerWindowBase {
 				_build_depot_direction = (DiagDirection)(widget - WID_BRAD_DEPOT_NE);
 				this->LowerWidget(_build_depot_direction + WID_BRAD_DEPOT_NE);
 				if (_settings_client.sound.click_beep) SndPlayFx(SND_15_BEEP);
+				EraseQueuedTouchCommand();
 				this->SetDirty();
 				break;
 		}
diff --git a/src/road_gui.cpp b/src/road_gui.cpp
index 1b7ea07..455eef1 100644
--- a/src/road_gui.cpp
+++ b/src/road_gui.cpp
@@ -894,6 +894,7 @@ struct BuildRoadDepotWindow : public PickerWindowBase {
 				_road_depot_orientation = (DiagDirection)(widget - WID_BROD_DEPOT_NE);
 				this->LowerWidget(_road_depot_orientation + WID_BROD_DEPOT_NE);
 				if (_settings_client.sound.click_beep) SndPlayFx(SND_15_BEEP);
+				EraseQueuedTouchCommand();
 				this->SetDirty();
 				break;
 
@@ -1040,6 +1041,7 @@ struct BuildRoadStationWindow : public PickerWindowBase {
 				_settings_client.gui.station_show_coverage = (widget != WID_BROS_LT_OFF);
 				this->LowerWidget(_settings_client.gui.station_show_coverage + WID_BROS_LT_OFF);
 				if (_settings_client.sound.click_beep) SndPlayFx(SND_15_BEEP);
+				EraseQueuedTouchCommand();
 				this->SetDirty();
 				break;
 
-- 
1.8.1.2

